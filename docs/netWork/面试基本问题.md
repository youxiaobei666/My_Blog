# 网络的基本知识

## 1. 什么是 CORS

CORS 是 Cross-Origin Resource Sharing 的缩写，`即跨域资源共享`。浏览器出于安全考虑，限制了通过 JavaScript 发起跨域请求的操作，而 CORS 就是一种机制，`允许服务器配置响应头信息`，从而`解决跨域`问题。

简单来说，当浏览器的源地址和请求目标地址不同时，浏览器会阻止该请求。使用 CORS 机制时，服务器可以在响应头中添加一些参数，告知浏览器允许指定源的请求访问服务端资源，从而使请求成功并返回相应数据。

CORS 的核心思想是：使用自定义 HTTP 头部让浏览器与服务器协商是否可以跨域，是一种服务器与浏览器之间的沟通。一般情况下，如果需要进行跨域请求，需要满足以下几个条件：

- 请求方法为 GET、POST、HEAD；
- 请求头部信息没有自定义项（一些常见的头部信息如 Content-Type、Accept 等属于预定义字段）；
- 响应头部中包含 Access-Control-Allow-Origin，且其值为请求来源或 \*。

以上只是 CORS 的一些基本概念和规则，具体使用过程中还需要根据实际情况进行配置。

## 2. 跨域问题？如何解决？

跨域问题是由于浏览器的同源策略限制所引起的。同源策略是指浏览器只允许相同源（协议、域名、端口号均相同）之间的请求和响应。如果不满足同源策略，浏览器就会报跨域错误。

常见的解决跨域问题的方式有以下几种：

- JSONP：通过动态插入`<script>`标签，利用 `callback` 函数来实现跨域请求。优点是简单易用，缺点是只能支持 GET 请求。

- CORS：后端设置响应头 `Access-Control-Allow-Origi`n 来允许跨域请求。优点是安全可靠，支持各种类型请求，缺点是需要后端进行设置。

- 代理服务器：在同域下设置一个代理服务器来转发请求，解决跨域问题。优点是能够支持各种类型请求，缺点是增加了服务器压力和复杂度。

- WebSocket：通过 WebSocket 协议的双向通信来实现跨域请求。优点是实时性好，支持双向通信，缺点是需要客户端和服务端同时支持 WebSocket 协议。

以上是常见的解决跨域问题的方式，具体的选择需要根据实际情况进行判断。

## 3. 三握四挥

三次握手（Three-way Handshake）和四次挥手（Four-way Handshake）是 TCP（传输控制协议）建立和终止连接过程中的关键步骤。它们确保通信双方都准备好发送或接收数据包，并且有序地关闭连接。

### 3.1 三次握手（建立连接）

三次握手的目的是创建一个可靠的双向通信通道。以下是三次握手步骤：

1. **SYN**：客户端向服务器发送一个带有 SYN（同步）标志的 TCP 数据包，请求建立连接。这个数据包同时包含一个随机序列号 A。
2. **SYN-ACK**：服务器收到 SYN 请求后，回应客户端一个带有 SYN 和 ACK（确认）标志的数据包，同时包含一个随机序列号 B，以及将客户端发送序列号 A��1 作为确认号(ACK Number)。
3. **ACK**：客户端收到服务器的 SYN-ACK 数据包后，再次向服务器发送确认数据包，带有 ACK 标志，ACK Number 为服务器发送序列号 B 加 1。

握手完成后，客户端与服务器之间就建立了一个可靠的双向连接。

### 3.2 四次挥手（终止连接）

四次挥手的目的是有序地关闭双向连接，避免数据丢失。以下是四次挥手的步骤：

1. **FIN**：当客户端完成数据发送后，向服务器发送一个带有 FIN（结束）标志的数据包，表示准备关闭连接。
2. **ACK**：服务器收到 FIN 数据包后，向客户端发送一个带有 ACK 标志的确认数据包，确认已接收到 FIN 数据包。此时，客户端到服务器的连接被关闭，但服务器还可以继续向客户端发送数据。
3. **FIN**：当服务器完成数据发送后，向客户端发送一个带有 FIN 标志的数据包，表示服务器准备关闭连接。
4. **ACK**：客户端收到服务器的 FIN 数据包后，向服务器发送一个带有 ACK 标志的确认数据包，表示已接收到 FIN 数据包。此时，从服务器到客户端的连接被关闭。

在最后一个 ACK 发送后，双方的连接完全关闭。为了确保最后一个 ACK 数据包已被接收，TCP 协议规定客户端在发送最后一个 ACK 数据包后，还需等待一个保持时间（通常为 2MSL，即最大报文段生存时间的两倍），然后才彻底关闭连接。这同样避免了 ACK 数据包的丢失。
